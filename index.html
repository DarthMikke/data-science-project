<html>
    <head>
        <title>Dashboard â€“ Fagforbundet</title>
        <!-- CSS only -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
        <!-- JavaScript Bundle with Popper -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.0/dist/chart.min.js" integrity="sha256-Y26AMvaIfrZ1EQU49pf6H4QzVTrOI8m9wQYKkftBt4s=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
        <script type="text/javascript">
            function createChart(ctx) {
                const config = {
                    type: 'line',
                    data: {
                        labels: ['2021V01'],
                        datasets: [
                            {label:'Innmeldingar', borderColor: 'blue', data: [1000]},
                            {label:'Utmeldingar', borderColor: 'red', data: [1000]}
                        ]
                    },
                    options: {}
                }

                return new Chart(ctx, config);
            }

            function updateChart(chart, labels, datasets) {
                console.log("Oppdaterer grafen.");
                console.log(chart.data);
                chart.data.labels = labels;
                chart.data.datasets = datasets;
                console.log(chart.data);
                chart.update();
            }

            var chart;

            async function load() {
                let response = await fetch('data.json');
                let json = await response.json();

                let data1, data2, labels;
                data1 = json.medlemsflyt.innmeldingar;
                data2 = json.medlemsflyt.utmeldingar;
                labels = json.medlemsflyt.datoar;

                const ctx = document.getElementById('myChart').getContext('2d');
                chart = createChart(ctx)

                updateChart(
                    chart,
                    labels, 
                    [
                        {
                            label:'Innmeldingar',
                            borderColor: 'blue',
                            data: data1
                        },
                        {
                            label:'Utmeldingar',
                            borderColor: 'red',
                            data: data2
                        }
                    ]
                );
            }
        </script>
    </head>
    <body onload="load();">
        <header class="">
            <nav>
                <div class="col-4">
                    <a class="navbar-brand" href="/">
                        <span class="sr-only">Tilbake til forsiden</span>
                        <img src="logo.svg" alt="Fagforbundet" class="logo">
                    </a>
                </div>
            </nav>
        </header>
        <div class="container-fluid ">
            <nav id="sidebar-menu">
            </nav>
            <main>
                <div id="inn-ut" class="col-md-6">
                    <div id="graf">
                        <h3>Inn- og utmeldingar</h3>
                         <!-- width="400" height="400" -->
                        <canvas id="myChart"></canvas>
                    </div>
                    <div id="inn-ut-detaljar">
                    </div>
                </div>
            </main>
        </div>
    </body>
</html>
